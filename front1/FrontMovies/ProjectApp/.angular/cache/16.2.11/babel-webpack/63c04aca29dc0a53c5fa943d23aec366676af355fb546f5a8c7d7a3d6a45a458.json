{"ast":null,"code":"import * as L from 'leaflet';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./map.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"src/app/accommodation/accommodation.service\";\nexport class MapComponent {\n  constructor(mapService, route, router, accommodationService) {\n    this.mapService = mapService;\n    this.route = route;\n    this.router = router;\n    this.accommodationService = accommodationService;\n  }\n  ngOnInit() {\n    this.route.paramMap.subscribe(params => {\n      const accommodationId = +params.get('id');\n      this.accommodationService.getById(accommodationId).subscribe(foundAccommodation => {\n        if (foundAccommodation) {\n          this.accommodation = foundAccommodation;\n          this.initMap(this.accommodation);\n        } else {\n          console.error(`Accommodation with ID ${accommodationId} not found`);\n        }\n      }, error => {\n        console.error('Error fetching accommodation:', error);\n      });\n    });\n  }\n  initMap(accommodation) {\n    this.map = L.map('map', {\n      center: [45.2396, 19.8227],\n      zoom: 13\n    });\n    const tiles = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n      maxZoom: 18,\n      minZoom: 3,\n      attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>'\n    });\n    tiles.addTo(this.map);\n    this.search(accommodation);\n  }\n  search(accommodation) {\n    if (accommodation) {\n      this.mapService.search(accommodation?.location.address + \", \" + accommodation?.location.city).subscribe({\n        next: result => {\n          L.marker([result[0].lat, result[0].lon]).addTo(this.map).bindPopup(accommodation.name).openPopup();\n        },\n        error: () => {}\n      });\n    }\n  }\n  ngAfterViewInit() {\n    if (this.accommodation) {\n      L.Marker.prototype.options.icon = L.icon({\n        iconUrl: 'https://unpkg.com/leaflet@1.6.0/dist/images/marker-icon.png'\n      });\n      this.initMap(this.accommodation);\n    }\n  }\n  static #_ = this.ɵfac = function MapComponent_Factory(t) {\n    return new (t || MapComponent)(i0.ɵɵdirectiveInject(i1.MapService), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.AccommodationService));\n  };\n  static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: MapComponent,\n    selectors: [[\"app-map\"]],\n    decls: 3,\n    vars: 0,\n    consts: [[\"rel\", \"stylesheet\", \"href\", \"https://unpkg.com/leaflet@1.6.0/dist/leaflet.css\"], [1, \"map-frame\"], [\"id\", \"map\"]],\n    template: function MapComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelement(0, \"link\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelement(2, \"div\", 2);\n        i0.ɵɵelementEnd();\n      }\n    },\n    styles: [\".map-frame[_ngcontent-%COMP%] {\\n    height: 600px;\\n    width: 80%;\\n    border: 2px solid black;\\n    margin: 50px;\\n  }\\n  \\n  #map[_ngcontent-%COMP%] {\\n    height: 100%;\\n    max-height: 600px;\\n    width:100%;\\n    \\n  }\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvbGF5b3V0L21hcC9tYXAuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtJQUNJLGFBQWE7SUFDYixVQUFVO0lBQ1YsdUJBQXVCO0lBQ3ZCLFlBQVk7RUFDZDs7RUFFQTtJQUNFLFlBQVk7SUFDWixpQkFBaUI7SUFDakIsVUFBVTs7RUFFWiIsInNvdXJjZXNDb250ZW50IjpbIi5tYXAtZnJhbWUge1xyXG4gICAgaGVpZ2h0OiA2MDBweDtcclxuICAgIHdpZHRoOiA4MCU7XHJcbiAgICBib3JkZXI6IDJweCBzb2xpZCBibGFjaztcclxuICAgIG1hcmdpbjogNTBweDtcclxuICB9XHJcbiAgXHJcbiAgI21hcCB7XHJcbiAgICBoZWlnaHQ6IDEwMCU7XHJcbiAgICBtYXgtaGVpZ2h0OiA2MDBweDtcclxuICAgIHdpZHRoOjEwMCU7XHJcbiAgICBcclxuICB9Il0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n  });\n}","map":{"version":3,"names":["L","MapComponent","constructor","mapService","route","router","accommodationService","ngOnInit","paramMap","subscribe","params","accommodationId","get","getById","foundAccommodation","accommodation","initMap","console","error","map","center","zoom","tiles","tileLayer","maxZoom","minZoom","attribution","addTo","search","location","address","city","next","result","marker","lat","lon","bindPopup","name","openPopup","ngAfterViewInit","Marker","prototype","options","icon","iconUrl","_","i0","ɵɵdirectiveInject","i1","MapService","i2","ActivatedRoute","Router","i3","AccommodationService","_2","selectors","decls","vars","consts","template","MapComponent_Template","rf","ctx","ɵɵelement","ɵɵelementStart","ɵɵelementEnd"],"sources":["C:\\Users\\USER\\Desktop\\FrontMovies\\ProjectApp\\src\\app\\layout\\map\\map.component.ts","C:\\Users\\USER\\Desktop\\FrontMovies\\ProjectApp\\src\\app\\layout\\map\\map.component.html"],"sourcesContent":["import {AfterViewInit, Component} from '@angular/core';\r\nimport * as L from 'leaflet';\r\nimport {MapService} from \"./map.service\";\r\nimport { ActivatedRoute, ParamMap, Router } from '@angular/router';\r\nimport { AccommodationService } from 'src/app/accommodation/accommodation.service';\r\nimport { Accommodation } from 'src/app/accommodation/accommodation/model/accommodation.model';\r\n@Component({\r\n  selector: 'app-map',\r\n  templateUrl: './map.component.html',\r\n  styleUrls: ['./map.component.css'],\r\n})\r\nexport class MapComponent implements AfterViewInit {\r\n  private map: any;\r\n  accommodation: Accommodation | undefined;\r\n  constructor(private mapService: MapService,\r\n    private route:ActivatedRoute,\r\n    private router:Router,\r\n    private accommodationService:AccommodationService) {}\r\n  \r\n  ngOnInit() {\r\n    this.route.paramMap.subscribe((params: ParamMap) => {\r\n      const accommodationId = +params.get('id')!;\r\n      this.accommodationService.getById(accommodationId).subscribe(\r\n        (foundAccommodation) => {\r\n          if (foundAccommodation) {\r\n            this.accommodation = foundAccommodation;\r\n            this.initMap(this.accommodation);\r\n          } else {\r\n            console.error(`Accommodation with ID ${accommodationId} not found`);\r\n          }\r\n        },\r\n        (error) => {\r\n          console.error('Error fetching accommodation:', error);\r\n        }\r\n      );\r\n    });\r\n}\r\n  private initMap(accommodation:Accommodation): void {\r\n    this.map = L.map('map', {\r\n      center: [45.2396, 19.8227],\r\n      zoom: 13,\r\n    });\r\n\r\n    const tiles = L.tileLayer(\r\n      'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\r\n      {\r\n        maxZoom: 18,\r\n        minZoom: 3,\r\n        attribution:\r\n          '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>',\r\n      }\r\n    );\r\n    tiles.addTo(this.map);\r\n    this.search(accommodation)\r\n  }\r\n\r\n  search(accommodation:Accommodation): void {\r\n    if(accommodation){\r\n    this.mapService.search(accommodation?.location.address+\", \"+accommodation?.location.city).subscribe({\r\n      next: (result) => {\r\n        L.marker([result[0].lat, result[0].lon])\r\n          .addTo(this.map)\r\n          .bindPopup(accommodation.name)\r\n          .openPopup();\r\n      },\r\n      error: () => {},\r\n    });\r\n    }\r\n    \r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n    if (this.accommodation) {\r\n      L.Marker.prototype.options.icon = L.icon({\r\n        iconUrl: 'https://unpkg.com/leaflet@1.6.0/dist/images/marker-icon.png',\r\n      });\r\n      this.initMap(this.accommodation);\r\n    }\r\n  }\r\n}\r\n","<link rel=\"stylesheet\" href=\"https://unpkg.com/leaflet@1.6.0/dist/leaflet.css\" />\r\n<div class=\"map-frame\">\r\n    <div id=\"map\"></div>\r\n  </div>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}